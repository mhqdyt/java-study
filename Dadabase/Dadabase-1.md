# 一、数据库介绍
## 1.数据库技术:
![image](https://github.com/mhqdyt/java-study/blob/master/images/Dadabase-1/1-1.png)
### 1.1数据库技术是数据库管理的有效技术，研究如何对数据进行科学管理，从而为人们提供可以共享的、安全的、可靠的技术。
### 1.2数据（Data）:数据是信息的表现形式和载体，可以是符号、文字、数字、语音、图像、视频等。
### 1.3记录：记录是在计算机中表示和存储数据的一种格式或是一种方法。
### 1.4数据库（Database，DB）：数据库是存放数据的仓库，是大量数据的集合。
#### 1.41存放在数据库中数据的特点：
* 永久存储<br>
* 有组织<br> 
* 可共享<br>
### 1.5数据库管理系统（DBMS）：数据库管理系统是一个能够科学组织和存储数据，高效地获取和维护数据的系统软件，是位于用户与操作系统之间的数据管理软件
#### 1.51功能：
* 数据定义功能
* 数据组织、存储和管理功能
* 数据操纵功能
* 数据库的事务管理和运行管理功能
* 数据库的建立和维护功能
* 与其他软件系统的通信功能
### 1.6数据库系统（Database System，DBS）：数据库系统是由数据库、数据库管理系统（及其应用开发工具）、应用程序和数据库管理员组成的存储、管理、处理和维护数据的系统。

## 2数据库技术的产生与发展
### 2.1数据库技术应数据管理任务的需求而产生。
### 2.2数据管理的发展：
> * 应用需求推动
> * 软硬件的飞速发展为基础
> * 三个阶段：人工管理，文件系统，数据库系统
### 2.3数据库系统的优势
> * 整体数据的结构化
> * 数据的共享性高,冗余度低且易补充
> * 数据独立性高
>> * 物理独立性
>> * 逻辑独立性
> * 统一管理和控制
>> * 数据地安全性保护
>> * 数据地完整性检查
>> * 并发控制
>> * 数据库恢复
### 2.4层次，网状，关系模型
### 层次模型
* 有且只有一个节点没有双亲，该节点被称之为根节点（root）
* 根节点以外的其他节点有且只有一个双亲结点。
### 网状模型
* 允许一个以上的节点无双亲
* 一个节点可以有多余一个的双亲
### 关系模型
* 建立在严格的数据概念基础上
* 关系必须是规范化的
* 关系的分量必须是一个不可分的数据项

### 2.5结构化查询语言（Structured Query Language）
### SQL语言
* 高级的非过程化编程语言，允许用户在高层数据结构上工作
* 不要求用户指定数据存放方法
* 不需要用户了解数据存放方式
* 底层结构完全不同的各种关系型数据库可以使用相同的SQL语言作为数据操作和管理的接口。
### 2.6关系型数据库ACID的特性
* 原子性(Atomicity)
* 一致性(Consistency)
* 隔离性<Isolation)
* 持久性(Durability)
### 2.7其他数据模型
* 面向对象数据模型
* XML数据模型
* RDF数据模型
### 2.8数据管理技术的新挑战
* 高度可扩展性和可伸缩性
* 数据类型多样和异构处理能力
* 数据处理时效性要求
* 大数据时代来临
### 2.9NoSQL技术特点和类型
### NoSQL(Not Only SQL):非关系型的、分布式的、不保证满足ACID特性的一类数据管理系统
### 技术特点
* 对数据进行分区,利用大量节点并行处理获得高性能,同时能够采用横向扩展方式
* 降低ACID一致性约束,允许暂时不一致,接受最终一致性.遵循BASE(Basically Available Soft state,Eventual consistency)原则
* 各数据分区提供备份(一般是三份),应对节点故障,提高系统可用性
### NoSQL分类
* 键值数据库
* 列分组数据库
* 文档型数据库
* 图数据库
### NoSQL并不是为了取代RDBMS
* 优势显著,缺点也较明显
* 与RDBMS一起构建完整的数据生态系统
### 2.10NewSQL浅谈
### NewSQL
* 指追求NoSQL的可扩展性同时能够支持关系模型(包括ACID特性)的关系型数据库系统,主要面向OLTP场景
* 能够支持SQL作为主要的使用语言
### NewSQL的分类
* 采用了新架构重新构建产品
* 采用Transparent Sharding中间件技术
* DAAS(Database-as-Service,数据库及服务)
## 3关系型数据库架构介绍
### 3.1单机架构
* 为了避免应用服务和数据库服务对资源的竞争，单机架构也从早期的单主机模式发展到数据库独立主机模式，把应用和数据服务分开。应用服务可以增加服务器数量，进行负载均衡，增加系统并发能力。 
* 优点
> * 部署集中，运维方便
* 缺点
> * 可扩展性
> * 存在单点故障
> * 单机会遇到性能瓶颈
### 3.2分组架构-主备
* 主备机架构
> * 数据库部署在两台服务器，其中承担数据读写服务的服务器称为“主机”
> * 另外一台服务器利用数据同步机制把主机的数据复制过来，称为“备机”
> * 同一时点，只有一台服务器对外提供数据服务
* 优点
> * 应用不需要针对数据库故障来增加开发量
> * 相对单机架构提升了数据容错性
* 缺点
> * 资源浪费
> * 性能压力还是集中在单机上，无法解决性能瓶颈问题
> * 当出现故障的时候，主备机切换需要一定的人工干预或者监控
### 3.3分组架构-主从
* 主从式架构
> * 部署模式和主备机模式相似，备机上升为从机，对外提供一定的数据服务
> * 通过读写分离方式分散压力：
>> * 写入，修改，删除操作，在写库（主机）完成
>> * 把查询请求，分配到读库（从机）
* 优点
> * 提升资源利用率
> * 从大并发读的使用场景，可以使用负载均衡在多个主从机间进行平衡。
> * 从机的扩展性比较灵活，扩容操作不会影响到业务进行
* 缺点
> * 延迟问题，数据同步到从机数据库时会有延迟，所以应用必须能够容忍短暂的不一致性，对于一致性要求非常高的场景是不适应的
> * 写操作的压力还是集中在主机上
> * 主机出现故障，需要人工实现主从切换，人工干预是需要响应时间的，自动切换复杂度较高
### 3.4分组架构-多主
* 多主架构
> * 数据库服务器互为主从，同时对外提供完整的数据服务
* 优点
> * 资源利用率较高的同时降低了单点故障的风险
* 缺点
> * 双主机都接受读写数据，要实现数据双向同步，双向复制同样会带来延迟问题，极端情况下有可能数据丢失
> * 数据库数量增加会导致数据同步问题变得极为复杂，实际应用中多见双机模式
### 3.5共享存储多活架构
* 共享存储的多活架构（Shared Disk）
> * 一种特殊的多主架构
> * 数据库服务共享数据存储，而多个服务器实现均衡负载
* 优点
> * 多个计算服务器提供高可用服务，提供了高级别的可用性。可伸缩性，避免了服务器集群的单点故障问题
> * 比较方便的横向扩展能够增加整体系统并行处理能力
* 缺点
> * 实现技术难度大
> * 当存储器接口带宽达到饱和的时候，增加节点并不能获得更高的性能，存储IO容易成为整个系统的性能瓶颈
### 3.6分片架构
* 分片架构（Sharding）主要表现形式就是水平数据分片架构
> * 把数据分散在多个节点上的分片方案，每一个分片包括数据库的一部分，称为一个shard
> * 多个节点都拥有相同的数据库结构，但不同分片的数据之间没有交集，所有分区数据的并集构成数据总体
> * 常见的分片算法有：根据列表值，范围取值和Hash值进行数据分片
* 优点
> * 数据分散在集群内的各个节点上，所有节点可以独立工作
### 3.7无共享架构
* 无共享架构（Share-Nothing）
> * 集群内每一个节点（处理单元）都完全拥有自己独立的CPU/内存/存储，不存在共享资源
> * 各节点（处理单元）处理自己本地的数据，处理结构可以向上层汇总或者通过通信协议在节点间流转
> * 节点是相互独立的，扩展能力强。整个集群拥有强大的并行处理能力
### 3.8MPP架构（Massively Parallel Processing）
* MPP：大规模并行处理（Massively Paraller Processing)
> * MPP是将任务并行的分散到多个服务器和节点上，在每个节点上计算完成后，将各自部分的结果汇总到一起得到最终的结果
* 特征
> * 任务并执行，分布式计算
* 常见的MPP产品
> * 无共享Master：Vertica，Teradata
> * 共享Master：Greenplum，Netezza
* 无共享Master：
> * 所有节点对等
> * 可以通过任意节点查询或者加载数据
> * 不存在性能瓶颈和单点风险
## 4关系型数据库主流应用场景
### 4.1联机事务处理（OnLine Transaction Processing）
* OLTP是传统关系型数据库的主要应用
> * 面向基面的，日常的事务处理，例如银行储蓄业务的存取交易，转账交易等
* 特点
> * 大量吞吐：大量的短在线事务（插入，更新，删除），非常快速的查询处理
> * 高并发，（准）实时响应
* 典型的OLTP场景
> * 零售系统
> * 金融交易系统
> * 火车机票销售系统
> * 秒杀活动
### 4.2联机分析处理（OnLine Analytical Procession）
* OLAP
> * 联机分析处理的概念最早是E.F.Codd于1993年相对OLTP系统而提出来的
> * 是指在数据的查询和分析操作，通常是对大量的历史数据查询和分析，涉及到的历史周期比较长，数据量大，在不同的层级上的汇总，聚合操作使得事务处理操作比较复杂
* 特点
> * 主要面向侧重于复杂查询，回答一些“战略性”问题
> * 数据处理方面聚焦于数据的聚合，汇总，分组计算，窗口计算等“分析型：数据加工操作
> * 从多维去使用和分析数据
* 典型的OLAP场景
> * 报表系统，CRM系统
> * 金融风险预测预警系统，反洗钱系统
> * 数据集市，数据仓库
### 4.3数据库性能衡量指标
* TPC（Transaction Procession Performance Council，事务处理性能委员会）
> * 职责是指定商务应用基准测试标准（Benchmark）的规范，性能和价格度量，并管理测试结果的发布
> * 制定的是标准规范而不是代码，任何厂家依据规范最优的构造自己的系统进行评测
> * 推出了很多基准测试标准，其中针对OLTP和OLAP分别有两个规范
* TPC-C规范
> * 面向OLTP系统，主要包括两个指标
>> * 流量指标：tpmC（tpm-transaction per minuete,即每分钟测试系统处理的事务数量）
>> * 性价比指标：Price（测试系统价格)/tmpC
* TCP-H规范
> * 面向OLAP系统
>> * 流量指标：qphH-Query per hour,即每小时处理的复杂查询数量
>> * 需要考虑测试数据集合大小，分为不同的测试数据集，制定了22个查询语句，可以根据产品微调
>> * 测试场景：数据加载，Power能力测试和Througput测试。

